function r(r){if(0===r.length)return 0;for(var t,e=r[0],n=0,o=1;o<r.length;o++)t=e+r[o],Math.abs(e)>=Math.abs(r[o])?n+=e-t+r[o]:n+=r[o]-t+e,e=t;return e+n}function t(t){if(0===t.length)throw new Error("mean requires at least one data point");return r(t)/t.length}function e(r,e){var n,o,a=t(r),i=0;if(2===e)for(o=0;o<r.length;o++)i+=(n=r[o]-a)*n;else for(o=0;o<r.length;o++)i+=Math.pow(r[o]-a,e);return i}function n(r){if(0===r.length)throw new Error("variance requires at least one data point");return e(r,2)/r.length}function o(r){if(1===r.length)return 0;var t=n(r);return Math.sqrt(t)}function a(r){if(0===r.length)throw new Error("mode requires at least one data point");if(1===r.length)return r[0];for(var t=r[0],e=NaN,n=0,o=1,a=1;a<r.length+1;a++)r[a]!==t?(o>n&&(n=o,e=t),o=1,t=r[a]):o++;return e}function i(r){return r.slice().sort(function(r,t){return r-t})}function h(r){if(0===r.length)throw new Error("min requires at least one data point");for(var t=r[0],e=1;e<r.length;e++)r[e]<t&&(t=r[e]);return t}function u(r){if(0===r.length)throw new Error("max requires at least one data point");for(var t=r[0],e=1;e<r.length;e++)r[e]>t&&(t=r[e]);return t}function f(r,t){var e=r.length*t;if(0===r.length)throw new Error("quantile requires at least one data point.");if(t<0||t>1)throw new Error("quantiles must be between 0 and 1");return 1===t?r[r.length-1]:0===t?r[0]:e%1!=0?r[Math.ceil(e)-1]:r.length%2==0?(r[e-1]+r[e])/2:r[e]}function s(r,t,e,n){for(e=e||0,n=n||r.length-1;n>e;){if(n-e>600){var o=n-e+1,a=t-e+1,i=Math.log(o),h=.5*Math.exp(2*i/3),u=.5*Math.sqrt(i*h*(o-h)/o);a-o/2<0&&(u*=-1),s(r,t,Math.max(e,Math.floor(t-a*h/o+u)),Math.min(n,Math.floor(t+(o-a)*h/o+u)))}var f=r[t],p=e,c=n;for(l(r,e,t),r[n]>f&&l(r,e,n);p<c;){for(l(r,p,c),p++,c--;r[p]<f;)p++;for(;r[c]>f;)c--}r[e]===f?l(r,e,c):l(r,++c,n),c<=t&&(e=c+1),t<=c&&(n=c-1)}}function l(r,t,e){var n=r[t];r[t]=r[e],r[e]=n}function p(r,t){var e=r.slice();if(Array.isArray(t)){!function(r,t){for(var e=[0],n=0;n<t.length;n++)e.push(v(r.length,t[n]));e.push(r.length-1),e.sort(g);var o=[0,e.length-1];for(;o.length;){var a=Math.ceil(o.pop()),i=Math.floor(o.pop());if(!(a-i<=1)){var h=Math.floor((i+a)/2);c(r,e[h],Math.floor(e[i]),Math.ceil(e[a])),o.push(i,h,h,a)}}}(e,t);for(var n=[],o=0;o<t.length;o++)n[o]=f(e,t[o]);return n}return c(e,v(e.length,t),0,e.length-1),f(e,t)}function c(r,t,e,n){t%1==0?s(r,t,e,n):(s(r,t=Math.floor(t),e,n),s(r,t+1,t+1,n))}function g(r,t){return r-t}function v(r,t){var e=r*t;return 1===t?r-1:0===t?0:e%1!=0?Math.ceil(e)-1:r%2==0?e-.5:e}function M(r,t){if(t<r[0])return 0;if(t>r[r.length-1])return 1;var e=function(r,t){var e=0,n=0,o=r.length;for(;n<o;)t<=r[e=n+o>>>1]?o=e:n=-~e;return n}(r,t);if(r[e]!==t)return e/r.length;e++;var n=function(r,t){var e=0,n=0,o=r.length;for(;n<o;)t>=r[e=n+o>>>1]?n=-~e:o=e;return n}(r,t);if(n===e)return e/r.length;var o=n-e+1;return o*(n+e)/2/o/r.length}function w(r){var t=p(r,.75),e=p(r,.25);if("number"==typeof t&&"number"==typeof e)return t-e}function x(r){return+p(r,.5)}function q(r){for(var t=x(r),e=[],n=0;n<r.length;n++)e.push(Math.abs(r[n]-t));return x(e)}function d(r,t){t=t||Math.random;for(var e,n,o=r.length;o>0;)n=Math.floor(t()*o--),e=r[o],r[o]=r[n],r[n]=e;return r}function m(r,t){return d(r.slice().slice(),t)}function b(r){for(var t,e=0,n=0;n<r.length;n++)0!==n&&r[n]===t||(t=r[n],e++);return e}function y(r,t){for(var e=[],n=0;n<r;n++){for(var o=[],a=0;a<t;a++)o.push(0);e.push(o)}return e}function E(r,t,e,n){var o;if(r>0){var a=(e[t]-e[r-1])/(t-r+1);o=n[t]-n[r-1]-(t-r+1)*a*a}else o=n[t]-e[t]*e[t]/(t+1);return o<0?0:o}function I(r,t,e,n,o,a,i){if(!(r>t)){var h=Math.floor((r+t)/2);n[e][h]=n[e-1][h-1],o[e][h]=h;var u=e;r>e&&(u=Math.max(u,o[e][r-1]||0)),u=Math.max(u,o[e-1][h]||0);var f,s,l,p=h-1;t<n.length-1&&(p=Math.min(p,o[e][t+1]||0));for(var c=p;c>=u&&!((f=E(c,h,a,i))+n[e-1][u-1]>=n[e][h]);--c)(s=E(u,h,a,i)+n[e-1][u-1])<n[e][h]&&(n[e][h]=s,o[e][h]=u),u++,(l=f+n[e-1][c-1])<n[e][h]&&(n[e][h]=l,o[e][h]=c);I(r,h-1,e,n,o,a,i),I(h+1,t,e,n,o,a,i)}}function P(r,e){if(r.length!==e.length)throw new Error("sampleCovariance requires samples with equal lengths");if(r.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var n=t(r),o=t(e),a=0,i=0;i<r.length;i++)a+=(r[i]-n)*(e[i]-o);return a/(r.length-1)}function C(r){if(r.length<2)throw new Error("sampleVariance requires at least two data points");return e(r,2)/(r.length-1)}function N(r){var t=C(r);return Math.sqrt(t)}function R(r,t,e,n){return(r*t+e*n)/(t+n)}function D(r){if(0===r.length)throw new Error("rootMeanSquare requires at least one data point");for(var t=0,e=0;e<r.length;e++)t+=Math.pow(r[e],2);return Math.sqrt(t/r.length)}var A=function(){this.totalCount=0,this.data={}};A.prototype.train=function(r,t){for(var e in this.data[t]||(this.data[t]={}),r){var n=r[e];void 0===this.data[t][e]&&(this.data[t][e]={}),void 0===this.data[t][e][n]&&(this.data[t][e][n]=0),this.data[t][e][n]++}this.totalCount++},A.prototype.score=function(r){var t,e={};for(var n in r){var o=r[n];for(t in this.data)e[t]={},e[t][n+"_"+o]=this.data[t][n]?(this.data[t][n][o]||0)/this.totalCount:0}var a={};for(t in e)for(var i in a[t]=0,e[t])a[t]+=e[t][i];return a};var S=function(){this.weights=[],this.bias=0};S.prototype.predict=function(r){if(r.length!==this.weights.length)return null;for(var t=0,e=0;e<this.weights.length;e++)t+=this.weights[e]*r[e];return(t+=this.bias)>0?1:0},S.prototype.train=function(r,t){if(0!==t&&1!==t)return null;r.length!==this.weights.length&&(this.weights=r,this.bias=1);var e=this.predict(r);if("number"==typeof e&&e!==t){for(var n=t-e,o=0;o<this.weights.length;o++)this.weights[o]+=n*r[o];this.bias+=n}return this};var T=1e-4;function _(r){if(r<0)throw new Error("factorial requires a non-negative value");if(Math.floor(r)!==r)throw new Error("factorial requires an integer input");for(var t=1,e=2;e<=r;e++)t*=e;return t}var z=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],B=607/128,K=Math.log(Math.sqrt(2*Math.PI));var U={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}};var G=Math.sqrt(2*Math.PI),H={gaussian:function(r){return Math.exp(-.5*r*r)/G}},W={nrd:function(r){var t=N(r),e=w(r);return"number"==typeof e&&(t=Math.min(t,e/1.34)),1.06*t*Math.pow(r.length,-.2)}};function J(r,t,e){var n,o;if(void 0===t)n=H.gaussian;else if("string"==typeof t){if(!H[t])throw new Error('Unknown kernel "'+t+'"');n=H[t]}else n=t;if(void 0===e)o=W.nrd(r);else if("string"==typeof e){if(!W[e])throw new Error('Unknown bandwidth method "'+e+'"');o=W[e](r)}else o=e;return function(t){var e=0,a=0;for(e=0;e<r.length;e++)a+=n((t-r[e])/o);return a/o/r.length}}var Q=Math.sqrt(2*Math.PI);function Y(r){for(var t=r,e=r,n=1;n<15;n++)t+=e*=r*r/(2*n+1);return Math.round(1e4*(.5+t/Q*Math.exp(-r*r/2)))/1e4}for(var Z=[],L=0;L<=3.09;L+=.01)Z.push(Y(L));function O(r){var t=1/(1+.5*Math.abs(r)),e=t*Math.exp(-Math.pow(r,2)-1.26551223+1.00002368*t+.37409196*Math.pow(t,2)+.09678418*Math.pow(t,3)-.18628806*Math.pow(t,4)+.27886807*Math.pow(t,5)-1.13520398*Math.pow(t,6)+1.48851587*Math.pow(t,7)-.82215223*Math.pow(t,8)+.17087277*Math.pow(t,9));return r>=0?1-e:e-1}function V(r){var t=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),e=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*t)+Math.log(1-r*r)/2,2)-Math.log(1-r*r)/t)-(2/(Math.PI*t)+Math.log(1-r*r)/2));return r>=0?e:-e}function X(r){if("number"==typeof r)return r<0?-1:0===r?0:1;throw new TypeError("not a number")}exports.linearRegression=function(r){var t,e,n=r.length;if(1===n)t=0,e=r[0][1];else{for(var o,a,i,h=0,u=0,f=0,s=0,l=0;l<n;l++)h+=a=(o=r[l])[0],u+=i=o[1],f+=a*a,s+=a*i;e=u/n-(t=(n*s-h*u)/(n*f-h*h))*h/n}return{m:t,b:e}},exports.linearRegressionLine=function(r){return function(t){return r.b+r.m*t}},exports.standardDeviation=o,exports.rSquared=function(r,t){if(r.length<2)return 1;for(var e=0,n=0;n<r.length;n++)e+=r[n][1];for(var o=e/r.length,a=0,i=0;i<r.length;i++)a+=Math.pow(o-r[i][1],2);for(var h=0,u=0;u<r.length;u++)h+=Math.pow(r[u][1]-t(r[u][0]),2);return 1-h/a},exports.mode=function(r){return a(i(r))},exports.modeFast=function(r){for(var t,e=new Map,n=0,o=0;o<r.length;o++){var a=e.get(r[o]);void 0===a?a=1:a++,a>n&&(t=r[o],n=a),e.set(r[o],a)}if(0===n)throw new Error("mode requires at last one data point");return t},exports.modeSorted=a,exports.min=h,exports.max=u,exports.extent=function(r){if(0===r.length)throw new Error("extent requires at least one data point");for(var t=r[0],e=r[0],n=1;n<r.length;n++)r[n]>e&&(e=r[n]),r[n]<t&&(t=r[n]);return[t,e]},exports.minSorted=function(r){return r[0]},exports.maxSorted=function(r){return r[r.length-1]},exports.extentSorted=function(r){return[r[0],r[r.length-1]]},exports.sum=r,exports.sumSimple=function(r){for(var t=0,e=0;e<r.length;e++)t+=r[e];return t},exports.product=function(r){for(var t=1,e=0;e<r.length;e++)t*=r[e];return t},exports.quantile=p,exports.quantileSorted=f,exports.quantileRank=function(r,t){return M(i(r),t)},exports.quantileRankSorted=M,exports.interquartileRange=w,exports.iqr=w,exports.medianAbsoluteDeviation=q,exports.mad=q,exports.chunk=function(r,t){var e=[];if(t<1)throw new Error("chunk size must be a positive number");if(Math.floor(t)!==t)throw new Error("chunk size must be an integer");for(var n=0;n<r.length;n+=t)e.push(r.slice(n,n+t));return e},exports.sampleWithReplacement=function(r,t,e){if(0===r.length)return[];e=e||Math.random;for(var n=r.length,o=[],a=0;a<t;a++){var i=Math.floor(e()*n);o.push(r[i])}return o},exports.shuffle=m,exports.shuffleInPlace=d,exports.sample=function(r,t,e){return m(r,e).slice(0,t)},exports.ckmeans=function(r,t){if(t>r.length)throw new Error("cannot generate more classes than there are data values");var e=i(r);if(1===b(e))return[e];var n=y(t,e.length),o=y(t,e.length);!function(r,t,e){for(var n=t[0].length,o=r[Math.floor(n/2)],a=[],i=[],h=0,u=void 0;h<n;++h)u=r[h]-o,0===h?(a.push(u),i.push(u*u)):(a.push(a[h-1]+u),i.push(i[h-1]+u*u)),t[0][h]=E(0,h,a,i),e[0][h]=0;for(var f=1;f<t.length;++f)I(f<t.length-1?f:n-1,n-1,f,t,e,a,i)}(e,n,o);for(var a=[],h=o[0].length-1,u=o.length-1;u>=0;u--){var f=o[u][h];a[u]=e.slice(f,h+1),u>0&&(h=f-1)}return a},exports.uniqueCountSorted=b,exports.sumNthPowerDeviations=e,exports.equalIntervalBreaks=function(r,t){if(r.length<2)return r;for(var e=h(r),n=u(r),o=[e],a=(n-e)/t,i=1;i<t;i++)o.push(o[0]+a*i);return o.push(n),o},exports.sampleCovariance=P,exports.sampleCorrelation=function(r,t){return P(r,t)/N(r)/N(t)},exports.sampleVariance=C,exports.sampleStandardDeviation=N,exports.sampleSkewness=function(r){if(r.length<3)throw new Error("sampleSkewness requires at least three data points");for(var e,n=t(r),o=0,a=0,i=0;i<r.length;i++)o+=(e=r[i]-n)*e,a+=e*e*e;var h=Math.sqrt(o/(r.length-1)),u=r.length;return u*a/((u-1)*(u-2)*Math.pow(h,3))},exports.sampleKurtosis=function(r){var e=r.length;if(e<4)throw new Error("sampleKurtosis requires at least four data points");for(var n,o=t(r),a=0,i=0,h=0;h<e;h++)a+=(n=r[h]-o)*n,i+=n*n*n*n;return(e-1)/((e-2)*(e-3))*(e*(e+1)*i/(a*a)-3*(e-1))},exports.permutationsHeap=function(r){for(var t=new Array(r.length),e=[r.slice()],n=0;n<r.length;n++)t[n]=0;for(var o=0;o<r.length;)if(t[o]<o){var a=0;o%2!=0&&(a=t[o]);var i=r[a];r[a]=r[o],r[o]=i,e.push(r.slice()),t[o]++,o=0}else t[o]=0,o++;return e},exports.combinations=function r(t,e){var n,o,a,i,h=[];for(n=0;n<t.length;n++)if(1===e)h.push([t[n]]);else for(a=r(t.slice(n+1,t.length),e-1),o=0;o<a.length;o++)(i=a[o]).unshift(t[n]),h.push(i);return h},exports.combinationsReplacement=function r(t,e){for(var n=[],o=0;o<t.length;o++)if(1===e)n.push([t[o]]);else for(var a=r(t.slice(o,t.length),e-1),i=0;i<a.length;i++)n.push([t[o]].concat(a[i]));return n},exports.addToMean=function(r,t,e){return r+(e-r)/(t+1)},exports.combineMeans=R,exports.combineVariances=function(r,t,e,n,o,a){var i=R(t,e,o,a);return(e*(r+Math.pow(t-i,2))+a*(n+Math.pow(o-i,2)))/(e+a)},exports.geometricMean=function(r){if(0===r.length)throw new Error("geometricMean requires at least one data point");for(var t=1,e=0;e<r.length;e++){if(r[e]<=0)throw new Error("geometricMean requires only positive numbers as input");t*=r[e]}return Math.pow(t,1/r.length)},exports.harmonicMean=function(r){if(0===r.length)throw new Error("harmonicMean requires at least one data point");for(var t=0,e=0;e<r.length;e++){if(r[e]<=0)throw new Error("harmonicMean requires only positive numbers as input");t+=1/r[e]}return r.length/t},exports.average=t,exports.mean=t,exports.median=x,exports.medianSorted=function(r){return f(r,.5)},exports.subtractFromMean=function(r,t,e){return(r*t-e)/(t-1)},exports.rootMeanSquare=D,exports.rms=D,exports.variance=n,exports.tTest=function(r,e){return(t(r)-e)/(o(r)/Math.sqrt(r.length))},exports.tTestTwoSample=function(r,e,n){var o=r.length,a=e.length;if(!o||!a)return null;n||(n=0);var i=t(r),h=t(e),u=C(r),f=C(e);return"number"==typeof i&&"number"==typeof h&&"number"==typeof u&&"number"==typeof f?(i-h-n)/Math.sqrt(((o-1)*u+(a-1)*f)/(o+a-2)*(1/o+1/a)):void 0},exports.BayesianClassifier=A,exports.bayesian=A,exports.PerceptronModel=S,exports.perceptron=S,exports.epsilon=T,exports.factorial=_,exports.gamma=function r(t){if(Number.isInteger(t))return t<=0?NaN:_(t-1);if(--t<0)return Math.PI/(Math.sin(Math.PI*-t)*r(-t));var e=t+.25;return Math.pow(t/Math.E,t)*Math.sqrt(2*Math.PI*(t+1/6))*(1+1/144/Math.pow(e,2)-1/12960/Math.pow(e,3)-257/207360/Math.pow(e,4)-52/2612736/Math.pow(e,5)+5741173/9405849600/Math.pow(e,6)+37529/18811699200/Math.pow(e,7))},exports.gammaln=function(r){if(r<=0)return Infinity;r--;for(var t=z[0],e=1;e<15;e++)t+=z[e]/(r+e);var n=B+.5+r;return K+Math.log(t)-n+(r+.5)*Math.log(n)},exports.bernoulliDistribution=function(r){if(r<0||r>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-r,r]},exports.binomialDistribution=function(r,t){if(!(t<0||t>1||r<=0||r%1!=0)){var e=0,n=0,o=[],a=1;do{o[e]=a*Math.pow(t,e)*Math.pow(1-t,r-e),n+=o[e],a=a*(r-++e+1)/e}while(n<1-T);return o}},exports.poissonDistribution=function(r){if(!(r<=0)){var t=0,e=0,n=[],o=1;do{n[t]=Math.exp(-r)*Math.pow(r,t)/o,e+=n[t],o*=++t}while(e<1-T);return n}},exports.chiSquaredDistributionTable=U,exports.chiSquaredGoodnessOfFit=function(r,e,n){for(var o=0,a=e(t(r)),i=[],h=[],u=0;u<r.length;u++)void 0===i[r[u]]&&(i[r[u]]=0),i[r[u]]++;for(var f=0;f<i.length;f++)void 0===i[f]&&(i[f]=0);for(var s in a)s in i&&(h[+s]=a[s]*r.length);for(var l=h.length-1;l>=0;l--)h[l]<3&&(h[l-1]+=h[l],h.pop(),i[l-1]+=i[l],i.pop());for(var p=0;p<i.length;p++)o+=Math.pow(i[p]-h[p],2)/h[p];return U[i.length-1-1][n]<o},exports.kernelDensityEstimation=J,exports.kde=J,exports.zScore=function(r,t,e){return(r-t)/e},exports.cumulativeStdNormalProbability=function(r){var t=Math.abs(r),e=Math.min(Math.round(100*t),Z.length-1);return r>=0?Z[e]:+(1-Z[e]).toFixed(4)},exports.standardNormalTable=Z,exports.errorFunction=O,exports.erf=O,exports.inverseErrorFunction=V,exports.probit=function(r){return 0===r?r=T:r>=1&&(r=1-T),Math.sqrt(2)*V(2*r-1)},exports.permutationTest=function(r,e,n,o){if(void 0===o&&(o=1e4),void 0===n&&(n="two_side"),"two_side"!==n&&"greater"!==n&&"less"!==n)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'");for(var a=t(r)-t(e),i=new Array(o),h=r.concat(e),u=Math.floor(h.length/2),f=0;f<o;f++){d(h);var s=h.slice(0,u),l=h.slice(u,h.length),p=t(s)-t(l);i[f]=p}var c=0;if("two_side"===n)for(var g=0;g<=o;g++)Math.abs(i[g])>=Math.abs(a)&&(c+=1);else if("greater"===n)for(var v=0;v<=o;v++)i[v]>=a&&(c+=1);else for(var M=0;M<=o;M++)i[M]<=a&&(c+=1);return c/o},exports.bisect=function(r,t,e,n,o){if("function"!=typeof r)throw new TypeError("func must be a function");for(var a=0;a<n;a++){var i=(t+e)/2;if(0===r(i)||Math.abs((e-t)/2)<o)return i;X(r(i))===X(r(t))?t=i:e=i}throw new Error("maximum number of iterations exceeded")},exports.quickselect=s,exports.sign=X,exports.numericSort=i;
//# sourceMappingURL=simple-statistics.js.map
